<!DOCTYPE html>
<html>
<head>

<!-- metadata -->
<!-- head 구성은 그냥 css랑 jquery파일 불러오는 거임 -->
    <meta charset="utf-8">
    <title>전곽위키</title>
    <link rel="stylesheet" href="../src/css/wikiStyle.css" />
    <link rel="stylesheet" href="documentStyle.css" />
    <script src="../src/js/jquery-3.4.1.min.js"></script>


</head>

<!-- txt파일인데 html이 적혀있지? 어차피 html로 가져올 내용이라 그런거임. 사실 이걸 html파일(index말고)에다가 넣어둬도
되긴 할 텐데 문법이 조금 이상해져서 txt파일에 넣어둠. 대신에 수정할 때 자동완성이 안 떠서 귀찮아짐.
코드에 관한 설명은 딱히 하기 귀찮고 맨 아래로 ㄱㄱ-->

<body>
    <!-- header -->
    <header>

        <div class="container" id="headContainer">
            <a href="../w/" id="logoAnker" class="fn">
                <img id="logo" src="../src/img/icon.png" alt="logo" />
            </a>
            <input id="searchTxt" type="text" class="fn" onkeydown="javascript:if(event.keyCode == 13){search();}"/>
            <button id="searchBtn" class="fn"><span style="text-align: center; font-size: 16pt;">검색</span></button>
            <span id="login">

                <!-- 로그인 창 -->
                <span id="loginInput">
                    <input id="id" type="text" placeholder="아이디">
                    <input id="pw" type="password" placeholder="비밀번호">
                </span>
                <!-- 로그인 버튼 -->
                <span id="loginBtn" class="fn">
    
                    <img id= "sign1" src="../src/img/sign1.png"  />
                    <img id= "sign2" class = "hidden" src="../src/img/sign2.png" />
                    <img id= "auth" class = "hidden" src="../src/img/auth.png" />
    
                </span>

            </span>
        </div>

    </header>

    <!-- navigation -->
    <nav>
        <div id="navContainer" class="container">
            <div class="navItem">
                <ul id="navList">
                    <li class="navLi">
                        <p id="upload" class="navBtn">업로드</p>
                        <div id="uploadDiv">
                            <form id="uploadForm" method="POST">
                                <input name="file" type="file" id="file">
                                <button type="button" id="uploadBtn">업로드</button>
                            </form>
                        </div>
                    </li>
                    <li class="navLi">
                        <p class="navBtn">버튼버튼</p>
                    </li>
                    <li class="navLi">
                        <p class="navBtn">버튼버튼</p>
                    </li>

                </ul>
            </div>
        </div>
    </nav>

    <!-- content -->
    <div id="contentContainer" class="container">

        <!-- article -->
        <article class="contentItem container" id="documentContainer">

            <!-- 문서 화면 (document) -->
            <!-- .documentTitle은 문서 제목-->

                <div id="menuContainer" class="container documentItem">

                    <h1 class="menuItem documentTitle">제목</h1>

                    <span class="container menuItem" id="toolContainer">
                        <button class="toolItem" id="editBtn">편집</button>
                        <button class="toolItem" id="historyBtn">역사</button>
                        <button class="toolItem" id="lastBtn">삭제</button>
                    </span>
                </div>
                <p class="documentItem inAndOut">해당하는 문서가 존재하지 않습니다.</p>

                <pre id="historyTxt" class="documentItem">아직 만들어지지 않은 문서입니다.</pre>
        </article>

        <!-- aside -->
        <aside class="contentItem">
            <p style="font-size: 1.2em; text-align: center;">수정된 문서</p>
            <hr>
            <a href="#" id="link1"></a>
            <hr>
            <a href="#" id="link2"></a>
            <hr>
            <a href="#" id="link3"></a>
            <hr>
            <a href="#" id="link4"></a>
            <hr>
            <a href="#" id="link5"></a>
            <hr>
            <a href="#" id="link6"></a>
            <hr>
            <a href="#" id="link7"></a>
            <hr>
            <a href="#" id="link8"></a>
            <hr>
            <a href="#" id="link9"></a>
            <hr>
            <a href="#" id="link10"></a>
            <hr>
        </aside>
    </div>
    <!--가운데 정렬 실패..두 p태그 사이에 큰 공간 생김-->
    <!--그리고 사이트 전체에 적용 안 됨-->
    <!--라이브러리에서 index 켰을 때만 됨-->
    <footer>
        <div class="container" id="footerContainer">

            <p class="footerItem">일단 가운데 정렬이 되게 바꿔보았다.</p>
            <p class="footerItem">로고 작게 한번 더 넣고 'made by (신설동아리)' 이런 거 넣으면 좋을 듯</p>

        </div>
    </footer>

    <!-- firebase -->
    <!-- The core Firebase JS SDK is always required and must be listed first -->
    <script src="https://www.gstatic.com/firebasejs/7.8.1/firebase-app.js"></script>

    <!-- TODO: Add SDKs for Firebase products that you want to use
     https://firebase.google.com/docs/web/setup#available-libraries -->
    <script src="https://www.gstatic.com/firebasejs/7.8.1/firebase-analytics.js"></script>

    <!-- scripts -->
    <script src="documentFunctions.js"></script>
    <script src="../src/js/wikiFunctions.js"></script>

    <!-- 주소로 입력해도 들어가지는 엄청나게 공들인 코드-->
    <!--스탑스탑스탑스탑스탑스탑스탑스탑스탑스탑스탑스탑스탑스탑스탑스탑스탑스탑스탑스탑스탑스탑스탑스탑스탑스탑스탑스탑스탑-->
    <!--스탑스탑스탑스탑스탑스탑스탑스탑스탑스탑스탑스탑스탑스탑스탑스탑스탑스탑스탑스탑스탑스탑스탑스탑스탑스탑스탑스탑스탑-->
    <!--스탑스탑스탑스탑스탑스탑스탑스탑스탑스탑스탑스탑스탑스탑스탑스탑스탑스탑스탑스탑스탑스탑스탑스탑스탑스탑스탑스탑스탑-->
    <!--스탑스탑스탑스탑스탑스탑스탑스탑스탑스탑스탑스탑스탑스탑스탑스탑스탑스탑스탑스탑스탑스탑스탑스탑스탑스탑스탑스탑스탑-->
    <!--자 여길 보세요. 이게 가장 힘들었던 코드임. javascript니까 현우나 재현이는 이해하려고 노력하고 나머지는 그렇구나 싶으면 됨.-->
    <script>
        //loadFile이라는 함수를 만듦. 매개변수는 i 일단 이 함수는 무시하고 아래를 봐. (var u부터)
        function loadFile(i) {
            //방금 loadFile에 인수로 u.replace(/ /gi, "%20")를 사용했는데 이건 u에서 띄어쓰기
            //(원래 " "이렇게 쓰는데 이러면 첫번째 띄어쓰기만 찾기 때문에 정규식이라는 것을 이용해서 / /gi 라고 씀.
            //  / /안에 바꿀 내용을 쓰면 되는데 띄어쓰기라 / /라고 썼음.)
            //를 찾아서 %20으로 바꾼다는 말이야.
            //예를 들어 주소에 http://cameo.zone/test/kch/123/126/137/146/jshswiki/w/남 현 우 라고 쳤으면
            //u=남%20현%20우%20 인거임.
            //이제 이 함수 안에서는 u가 아니라 i겠지만.

            $(".documentTitle").text(i.replace(/%20/gi, " "));
            //이건 jquery를 이용해서 클래스가 documentTitle인 태그의 text를 i.replace(/20%/gi, " ")로 바꾸겠다는 거임.
            //이게 뭐냐면 제목 text거든 그래서 이 코드는 제목을 남 현 우 로 바꾸겠다는 거야.
            //앞으로 앞에 $붙어 있으면 다 jquery임.

            $.post("readphp.php", { title: i.replace(/%20/gi, " ") }, function (data, status) {

                if (status == "success") {

                    $(".inAndOut").html(data);

                }

                history.pushState("", "", i);

            });
            //.load는 그 뒤 괄호 안에 있는 파일을 읽어오는 거야. index에도 있었지.
            //괄호 안에는 파일의 주소와 함수가 하나 있는데 함수는 필요에 따라 넣고 뺄 수 있음. 난 필요해서 넣었어.
            //주소를 살펴보면 ../w/남%20현%20우.txt 가 됨. 근데 그 파일이 없잖아. 그러면 이제 함수 쪽에서 status의 값을 error로 바꿈. 
            //만약 파일이 있었으면 .load자체에서 문서 내용 텍스트에 파일 내용을 바로 넣어주고 status값이 success였나?
            //여기서 한가지 더 문제가 있지. 저 %20이 자동으로 스페이스로 바뀌더라고... 그래서 w폴더를 보면 알겠지만
            //Lorem%20ipsum.txt가 아니라 Lorem ipsum.txt임.

            //자 에러가 났어. 그러면


            //문서 내용부분 텍스트를 이렇게 바꾸는 거지.

            //그리고 파일을 찾았든 못 찾았든 주소창의 값을 바꿀거야
            //history.pushState(a, b, c); 이 때 a, b는 나도 딱히 안 찾아봤는데 주소창에 내용은 c부분이야.
            //그래서 a,b부분에는 ""을 넣어뒀고 c부분에 주소값을 넣음. (맨 뒤의 값만.)
            //i가 남%20현%20우 였으니까 이제 주소창에는 이렇게 써 있겠지.
            //http://cameo.zone/test/kch/123/126/137/146/jshswiki/w/남%20현%20우
            //그리고 현재 페이지에는 남현우 파일이 없는데도 있는 척을 하면서 편집을 누르면 새 문서를 만든다고 나옴.
            //일단 다시 위키 원리 설명.txt로 돌아가자.


        }

        var v = decodeURI(document.URL.split("/").pop());
        var u = v.split("#")[0];

        if (u != "") {

            loadFile(u.replace(/ /gi, "%20"));

        } else {

            loadFile("전곽위키:대문");
        }

        loadLog();

//u라는 변수를 만들었는데 그 값이decodeURI(document.URL.split("/").pop())이야.
//안에부터 살펴보자면 document.URL은 지금 사이트의 url을 불러오는 거야.
//.split("/")은 .앞의 값 (즉 주소)를 /을 기준으로 나눠서 배열로 만들어.
//.pop()은 배열의 가장 마지막 값을 빼내와서 반환해줘.
//decodeURI()는 ()안의 값을 디코딩 해 주는 건데 원래 주소창에 뭔가를 쓰게 되면 자동으로 인코딩이 된단 말이야.
//보기에는 안 그런데 막상 값을 가져오면 그렇게 됨. 그래서 디코딩을 해 줘야 우리가 원하는 값을 얻게 됨.

//자 총 정리! <현재 주소의 가장 마지막 부분을 가져와서 u라는 변수에 집어넣는다.>

//주소창에 만약 아무것도 입력하지 않았어. 그러면 내가 좀 전에 말했던 기본주소
//즉 http://cameo.zone/test/kch/123/126/137/146/jshswiki/w를 입력했다면 아마 자동으로
//http://cameo.zone/test/kch/123/126/137/146/jshswiki/w/ 로 인식될거고 그러면 u의 값이 ""이 됨.
//따라서 u가 ""인 경우에는 기본 페이지 (Lorem%20ipsum)을 출력하는 거임.
//%20은 아스키 16진법으로 스페이스 바 눌렀을 때 나오는 스페이스를 의미함. 주소창에 인코드 된 값이 %20임.
//그럼 이제 loadFile를 사용했으니까 다시 올라가 보자.


    </script>

</body>

</html>